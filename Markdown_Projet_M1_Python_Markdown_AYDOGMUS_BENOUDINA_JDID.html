<!DOCTYPE html>
<html lang="en"><head>
<script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/clipboard/clipboard.min.js"></script>
<script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/tabby.min.js"></script>
<script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/popper.min.js"></script>
<script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.29">

  <meta name="author" content="Belinda AYDOGMUS">
  <meta name="author" content="Myriam Magda BENOUDINA">
  <meta name="author" content="Sihame JDID">
  <title>Corporate Bond Pricer</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/dist/theme/quarto-816793a8a4a837d14f6ea458e2f1c5cb.css">
  <link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Corporate Bond Pricer</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Belinda AYDOGMUS 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Myriam Magda BENOUDINA 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sihame JDID 
</div>
</div>
</div>

</section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>

<section id="i.-mise-en-place-de-lenvironnement" class="title-slide slide level1 center">
<h1>I. Mise en place de l’environnement</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="co">##### MISE EN PLACE DE L'ENVIRONNEMENT #####</span></span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a><span class="co"># Installation des modules #</span></span>
<span id="cb1-4"><a href=""></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href=""></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb1-8"><a href=""></a><span class="im">from</span> tkinter <span class="im">import</span> ttk, messagebox</span>
<span id="cb1-9"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href=""></a><span class="im">from</span> fredapi <span class="im">import</span> Fred</span>
<span id="cb1-11"><a href=""></a><span class="im">from</span> scipy <span class="im">import</span> interpolate</span>
<span id="cb1-12"><a href=""></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb1-13"><a href=""></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb1-14"><a href=""></a><span class="im">from</span> selenium.webdriver.chrome.service <span class="im">import</span> Service</span>
<span id="cb1-15"><a href=""></a><span class="im">from</span> webdriver_manager.chrome <span class="im">import</span> ChromeDriverManager</span>
<span id="cb1-16"><a href=""></a><span class="im">import</span> time</span>
<span id="cb1-17"><a href=""></a></span>
<span id="cb1-18"><a href=""></a><span class="co"># Forcage du bon dossier </span></span>
<span id="cb1-19"><a href=""></a>project_path <span class="op">=</span> <span class="vs">r"C:</span><span class="er">\</span><span class="vs">Users</span><span class="dv">\s</span><span class="vs">iham</span><span class="er">\</span><span class="vs">OneDrive</span><span class="dv">\D</span><span class="vs">ocuments</span><span class="dv">\M</span><span class="vs">1</span><span class="dv">\S</span><span class="vs">2</span><span class="er">\</span><span class="vs">PYTHON"</span></span>
<span id="cb1-20"><a href=""></a>os.chdir(project_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>

<section>
<section id="ii.-base-de-données" class="title-slide slide level1 center">
<h1>II. Base de données</h1>

</section>
<section id="a.-us-yield-curve" class="slide level2">
<h2>A. US Yield Curve</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="co">##### DATA BASE #####</span></span>
<span id="cb2-2"><a href=""></a></span>
<span id="cb2-3"><a href=""></a><span class="co">## US YIELD CURVE ##</span></span>
<span id="cb2-4"><a href=""></a><span class="co"># FRED API key : ce6755615bc789593ab6aed48597ea81</span></span>
<span id="cb2-5"><a href=""></a></span>
<span id="cb2-6"><a href=""></a>fred <span class="op">=</span> Fred(api_key<span class="op">=</span><span class="st">'ce6755615bc789593ab6aed48597ea81'</span>) </span>
<span id="cb2-7"><a href=""></a></span>
<span id="cb2-8"><a href=""></a><span class="co"># Dictionnaire des maturités &amp; codes FRED correspondants</span></span>
<span id="cb2-9"><a href=""></a>series_ids <span class="op">=</span> {</span>
<span id="cb2-10"><a href=""></a>    <span class="st">'1M'</span>: <span class="st">'GS1M'</span>,</span>
<span id="cb2-11"><a href=""></a>    <span class="st">'3M'</span>: <span class="st">'GS3M'</span>,</span>
<span id="cb2-12"><a href=""></a>    <span class="st">'6M'</span>: <span class="st">'GS6M'</span>,</span>
<span id="cb2-13"><a href=""></a>    <span class="st">'1Y'</span>: <span class="st">'GS1'</span>,</span>
<span id="cb2-14"><a href=""></a>    <span class="st">'2Y'</span>: <span class="st">'GS2'</span>,</span>
<span id="cb2-15"><a href=""></a>    <span class="st">'3Y'</span>: <span class="st">'GS3'</span>,</span>
<span id="cb2-16"><a href=""></a>    <span class="st">'5Y'</span>: <span class="st">'GS5'</span>,</span>
<span id="cb2-17"><a href=""></a>    <span class="st">'7Y'</span>: <span class="st">'GS7'</span>,</span>
<span id="cb2-18"><a href=""></a>    <span class="st">'10Y'</span>: <span class="st">'GS10'</span>,</span>
<span id="cb2-19"><a href=""></a>    <span class="st">'20Y'</span>: <span class="st">'GS20'</span>,</span>
<span id="cb2-20"><a href=""></a>    <span class="st">'30Y'</span>: <span class="st">'GS30'</span></span>
<span id="cb2-21"><a href=""></a>}</span>
<span id="cb2-22"><a href=""></a></span>
<span id="cb2-23"><a href=""></a><span class="co"># Récupération des derniers taux disponibles</span></span>
<span id="cb2-24"><a href=""></a>rates <span class="op">=</span> {}</span>
<span id="cb2-25"><a href=""></a><span class="cf">for</span> label, code <span class="kw">in</span> series_ids.items():</span>
<span id="cb2-26"><a href=""></a>    <span class="cf">try</span>:</span>
<span id="cb2-27"><a href=""></a>        rates[label] <span class="op">=</span> fred.get_series(code).dropna().iloc[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-28"><a href=""></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb2-29"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"Erreur pour </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>code<span class="sc">}</span><span class="ss">) : </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-30"><a href=""></a></span>
<span id="cb2-31"><a href=""></a><span class="co"># Construction d’un DataFrame</span></span>
<span id="cb2-32"><a href=""></a>df <span class="op">=</span> pd.DataFrame(rates.items(), columns<span class="op">=</span>[<span class="st">'Maturity'</span>, <span class="st">'Rate'</span>])  <span class="co"># Sépare bien Maturity et Rate</span></span>
<span id="cb2-33"><a href=""></a>df[<span class="st">'Rate'</span>] <span class="op">=</span> df[<span class="st">'Rate'</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb2-34"><a href=""></a></span>
<span id="cb2-35"><a href=""></a><span class="co"># Chemin du fichier CSV</span></span>
<span id="cb2-36"><a href=""></a>csv_path <span class="op">=</span> <span class="st">"C:/Users/siham/OneDrive/Documents/M1/S2/PYTHON/US_Yield_Curve.csv"</span></span>
<span id="cb2-37"><a href=""></a></span>
<span id="cb2-38"><a href=""></a><span class="co"># Vérification si le fichier existe déjà</span></span>
<span id="cb2-39"><a href=""></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(csv_path):</span>
<span id="cb2-40"><a href=""></a>    <span class="co"># Sauvegarde dans un fichier CSV si il n'existe pas</span></span>
<span id="cb2-41"><a href=""></a>    df.to_csv(csv_path, index<span class="op">=</span><span class="va">False</span>, sep<span class="op">=</span><span class="st">','</span>)  </span>
<span id="cb2-42"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Le fichier CSV n'existait pas, il a été créé à : </span><span class="sc">{</span>csv_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-43"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb2-44"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Le fichier CSV existe déjà à : </span><span class="sc">{</span>csv_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-45"><a href=""></a></span>
<span id="cb2-46"><a href=""></a><span class="co"># Affichage graphique</span></span>
<span id="cb2-47"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb2-48"><a href=""></a>plt.plot(df[<span class="st">'Maturity'</span>], df[<span class="st">'Rate'</span>], marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb2-49"><a href=""></a>plt.title(<span class="st">"US Treasury Yield Curve"</span>)</span>
<span id="cb2-50"><a href=""></a>plt.xlabel(<span class="st">"Maturity"</span>)</span>
<span id="cb2-51"><a href=""></a>plt.ylabel(<span class="st">"Rate (%)"</span>)</span>
<span id="cb2-52"><a href=""></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-53"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="courbe-des-taux-sans-risque-us">Courbe des taux sans risque US</h3>

<img data-src="Graphique_US_Yield_Curve.png" class="r-stretch"></section>
<section id="b.-euribor-3m-curve" class="slide level2">
<h2>B. EURIBOR 3M Curve</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="co">## EURIBOR 3M CURVE ##</span></span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="co"># Vérifier si le fichier existe déjà</span></span>
<span id="cb3-4"><a href=""></a>csv_file <span class="op">=</span> <span class="st">"euribor_rates_interpolated.csv"</span></span>
<span id="cb3-5"><a href=""></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(csv_file):  <span class="co"># Si le fichier n'existe pas, on exécute le code pour scraper et créer le CSV</span></span>
<span id="cb3-6"><a href=""></a>    <span class="bu">print</span>(<span class="st">"Le fichier n'existe pas. Début de l'extraction et de l'interpolation des données..."</span>)</span>
<span id="cb3-7"><a href=""></a></span>
<span id="cb3-8"><a href=""></a>    <span class="co"># Lancer le driver Selenium</span></span>
<span id="cb3-9"><a href=""></a>    driver <span class="op">=</span> webdriver.Chrome(service<span class="op">=</span>Service(ChromeDriverManager().install()))</span>
<span id="cb3-10"><a href=""></a></span>
<span id="cb3-11"><a href=""></a>    <span class="co"># URL de la page à scraper</span></span>
<span id="cb3-12"><a href=""></a>    url <span class="op">=</span> <span class="st">'https://www.chathamfinancial.com/technology/european-market-rates'</span></span>
<span id="cb3-13"><a href=""></a></span>
<span id="cb3-14"><a href=""></a>    <span class="co"># Ouverture de la page dans un navigateur avec Selenium</span></span>
<span id="cb3-15"><a href=""></a>    driver.get(url)</span>
<span id="cb3-16"><a href=""></a></span>
<span id="cb3-17"><a href=""></a>    <span class="co"># Attente de 5 secondes pour s'assurer que la page est bien chargée</span></span>
<span id="cb3-18"><a href=""></a>    time.sleep(<span class="dv">5</span>)</span>
<span id="cb3-19"><a href=""></a></span>
<span id="cb3-20"><a href=""></a>    <span class="co"># Récupération du contenu de la page une fois que la page est chargée</span></span>
<span id="cb3-21"><a href=""></a>    <span class="cf">try</span>:</span>
<span id="cb3-22"><a href=""></a>        <span class="co"># Utilisation de BeautifulSoup pour analyser le HTML</span></span>
<span id="cb3-23"><a href=""></a>        soup <span class="op">=</span> BeautifulSoup(driver.page_source, <span class="st">'html.parser'</span>)</span>
<span id="cb3-24"><a href=""></a></span>
<span id="cb3-25"><a href=""></a>        <span class="co"># Trouver tous les tableaux sur la page</span></span>
<span id="cb3-26"><a href=""></a>        tables <span class="op">=</span> soup.find_all(<span class="st">'table'</span>)</span>
<span id="cb3-27"><a href=""></a></span>
<span id="cb3-28"><a href=""></a>        <span class="co"># Vérification si la page contient au moins 4 tableaux (on veut récupérer le 4ème)</span></span>
<span id="cb3-29"><a href=""></a>        <span class="cf">if</span> <span class="bu">len</span>(tables) <span class="op">&gt;=</span> <span class="dv">4</span>:</span>
<span id="cb3-30"><a href=""></a>            <span class="co"># Extraction du 4ème tableau (index 3)</span></span>
<span id="cb3-31"><a href=""></a>            table <span class="op">=</span> tables[<span class="dv">3</span>]</span>
<span id="cb3-32"><a href=""></a></span>
<span id="cb3-33"><a href=""></a>            <span class="co"># Extraction des lignes du tableau</span></span>
<span id="cb3-34"><a href=""></a>            rows <span class="op">=</span> table.find_all(<span class="st">'tr'</span>)</span>
<span id="cb3-35"><a href=""></a></span>
<span id="cb3-36"><a href=""></a>            <span class="co"># Initialisation des listes pour les données</span></span>
<span id="cb3-37"><a href=""></a>            maturities <span class="op">=</span> []</span>
<span id="cb3-38"><a href=""></a>            rates_2025 <span class="op">=</span> []</span>
<span id="cb3-39"><a href=""></a></span>
<span id="cb3-40"><a href=""></a>            <span class="co"># Extraction des données de chaque ligne du tableau</span></span>
<span id="cb3-41"><a href=""></a>            <span class="cf">for</span> row <span class="kw">in</span> rows[<span class="dv">1</span>:]:  <span class="co"># Ignore la première ligne (en-têtes)</span></span>
<span id="cb3-42"><a href=""></a>                cols <span class="op">=</span> row.find_all(<span class="st">'td'</span>)</span>
<span id="cb3-43"><a href=""></a>                <span class="cf">if</span> <span class="bu">len</span>(cols) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb3-44"><a href=""></a>                    maturities.append(cols[<span class="dv">0</span>].text.strip())  <span class="co"># La première colonne est la maturité</span></span>
<span id="cb3-45"><a href=""></a>                    rates_2025.append(cols[<span class="dv">1</span>].text.strip())  <span class="co"># Taux pour 2025</span></span>
<span id="cb3-46"><a href=""></a></span>
<span id="cb3-47"><a href=""></a>            <span class="co"># Création d'un DataFrame avec les colonnes 'Maturity' et 'Rate_2025'</span></span>
<span id="cb3-48"><a href=""></a>            df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-49"><a href=""></a>                <span class="st">'Maturity'</span>: maturities,</span>
<span id="cb3-50"><a href=""></a>                <span class="st">'Rate_2025'</span>: rates_2025</span>
<span id="cb3-51"><a href=""></a>            })</span>
<span id="cb3-52"><a href=""></a></span>
<span id="cb3-53"><a href=""></a>            <span class="co"># Affichage du DataFrame</span></span>
<span id="cb3-54"><a href=""></a>            <span class="bu">print</span>(<span class="st">"Tableau des taux existants :"</span>)</span>
<span id="cb3-55"><a href=""></a>            <span class="bu">print</span>(df)</span>
<span id="cb3-56"><a href=""></a></span>
<span id="cb3-57"><a href=""></a>            <span class="co"># Interpolation pour ajouter les maturités manquantes</span></span>
<span id="cb3-58"><a href=""></a>            maturities_existing <span class="op">=</span> [<span class="bu">float</span>(m.split()[<span class="dv">0</span>]) <span class="cf">for</span> m <span class="kw">in</span> maturities]  <span class="co"># Convertir maturité en float</span></span>
<span id="cb3-59"><a href=""></a>            rates_existing <span class="op">=</span> [<span class="bu">float</span>(rate.strip(<span class="st">'%'</span>)) <span class="cf">for</span> rate <span class="kw">in</span> rates_2025]  <span class="co"># Convertir taux en float et supprimer '%'  </span></span>
<span id="cb3-60"><a href=""></a></span>
<span id="cb3-61"><a href=""></a>            <span class="co"># Maturités souhaitées</span></span>
<span id="cb3-62"><a href=""></a>            maturities_to_add <span class="op">=</span> [<span class="dv">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>]</span>
<span id="cb3-63"><a href=""></a></span>
<span id="cb3-64"><a href=""></a>            <span class="co"># Fonction d'interpolation linéaire</span></span>
<span id="cb3-65"><a href=""></a>            interp_func <span class="op">=</span> interpolate.interp1d(maturities_existing, rates_existing, kind<span class="op">=</span><span class="st">'linear'</span>, fill_value<span class="op">=</span><span class="st">"extrapolate"</span>)</span>
<span id="cb3-66"><a href=""></a></span>
<span id="cb3-67"><a href=""></a>            <span class="co"># Interpolation pour les nouvelles maturités</span></span>
<span id="cb3-68"><a href=""></a>            interpolated_rates <span class="op">=</span> interp_func(maturities_to_add)</span>
<span id="cb3-69"><a href=""></a></span>
<span id="cb3-70"><a href=""></a>            <span class="co"># Création d'un DataFrame avec les nouvelles maturités et leurs taux interpolés</span></span>
<span id="cb3-71"><a href=""></a>            df_interpolated <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-72"><a href=""></a>                <span class="st">'Maturity'</span>: maturities_to_add,</span>
<span id="cb3-73"><a href=""></a>                <span class="st">'Interpolated_Rate_2025'</span>: interpolated_rates</span>
<span id="cb3-74"><a href=""></a>            })</span>
<span id="cb3-75"><a href=""></a></span>
<span id="cb3-76"><a href=""></a>            <span class="co"># Affichage du DataFrame interpolé</span></span>
<span id="cb3-77"><a href=""></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Tableau des taux interpolés :"</span>)</span>
<span id="cb3-78"><a href=""></a>            <span class="bu">print</span>(df_interpolated)</span>
<span id="cb3-79"><a href=""></a></span>
<span id="cb3-80"><a href=""></a>            <span class="co"># Sauvegarde des données dans un fichier CSV</span></span>
<span id="cb3-81"><a href=""></a>            df_interpolated.to_csv(csv_file, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-82"><a href=""></a>            <span class="bu">print</span>(<span class="ss">f"Les données interpolées ont été sauvegardées à : </span><span class="sc">{</span>csv_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-83"><a href=""></a></span>
<span id="cb3-84"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb3-85"><a href=""></a>            <span class="bu">print</span>(<span class="st">"Moins de 4 tableaux trouvés sur la page."</span>)</span>
<span id="cb3-86"><a href=""></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-87"><a href=""></a>        <span class="bu">print</span>(<span class="st">"Erreur lors de la récupération des données : "</span>, e)</span>
<span id="cb3-88"><a href=""></a></span>
<span id="cb3-89"><a href=""></a>    <span class="co"># Fermer le navigateur après l'extraction des données</span></span>
<span id="cb3-90"><a href=""></a>    driver.quit()</span>
<span id="cb3-91"><a href=""></a></span>
<span id="cb3-92"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb3-93"><a href=""></a>    <span class="bu">print</span>(<span class="st">"Le fichier existe déjà. Aucun besoin de scraper à nouveau."</span>)</span>
<span id="cb3-94"><a href=""></a></span>
<span id="cb3-95"><a href=""></a><span class="co"># Affichage du graphique et du contenu du fichier CSV</span></span>
<span id="cb3-96"><a href=""></a><span class="cf">if</span> os.path.exists(csv_file):</span>
<span id="cb3-97"><a href=""></a>    <span class="co"># Chargement des données à partir du CSV si le fichier existe déjà</span></span>
<span id="cb3-98"><a href=""></a>    df_interpolated <span class="op">=</span> pd.read_csv(csv_file)</span>
<span id="cb3-99"><a href=""></a></span>
<span id="cb3-100"><a href=""></a>    <span class="co"># Affichage du graphique</span></span>
<span id="cb3-101"><a href=""></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Affichage du graphique :"</span>)</span>
<span id="cb3-102"><a href=""></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb3-103"><a href=""></a>    plt.plot(df_interpolated[<span class="st">'Maturity'</span>], df_interpolated[<span class="st">'Interpolated_Rate_2025'</span>], <span class="st">'ro-'</span>, label<span class="op">=</span><span class="st">'Taux interpolés'</span>)</span>
<span id="cb3-104"><a href=""></a>    plt.title(<span class="st">"Courbe des taux EURIBOR 3 mois (Interpolée)"</span>)</span>
<span id="cb3-105"><a href=""></a>    plt.xlabel(<span class="st">"Maturité (années)"</span>)</span>
<span id="cb3-106"><a href=""></a>    plt.ylabel(<span class="st">"Taux (%)"</span>)</span>
<span id="cb3-107"><a href=""></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb3-108"><a href=""></a>    plt.legend()</span>
<span id="cb3-109"><a href=""></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section class="slide level2">

<h3 id="courbe-euribor-3m">Courbe EURIBOR 3M</h3>

<img data-src="Graphique_EURIBOR_3M_Curve.png" class="r-stretch"></section>
<section id="c.-cdx-ig-prices" class="slide level2">
<h2>C. CDX IG Prices</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="co">## CDX IG PRICES ##</span></span>
<span id="cb4-2"><a href=""></a><span class="co"># Les données proviennent de Bloomberg /!\</span></span>
<span id="cb4-3"><a href=""></a></span>
<span id="cb4-4"><a href=""></a><span class="co"># Nom du fichier</span></span>
<span id="cb4-5"><a href=""></a>filename <span class="op">=</span> <span class="st">"CDX_IG_Prices.csv"</span></span>
<span id="cb4-6"><a href=""></a></span>
<span id="cb4-7"><a href=""></a><span class="co"># Vérifier si le fichier existe déjà</span></span>
<span id="cb4-8"><a href=""></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(filename):</span>
<span id="cb4-9"><a href=""></a>    <span class="co"># Données</span></span>
<span id="cb4-10"><a href=""></a>    data <span class="op">=</span> {</span>
<span id="cb4-11"><a href=""></a>        <span class="st">"Name"</span>: [</span>
<span id="cb4-12"><a href=""></a>            <span class="st">"21st Century Fox America Inc"</span>, <span class="st">"Allstate Corp/The"</span>, <span class="st">"Apache Corp"</span>, <span class="st">"AT&amp;T Inc"</span>, <span class="st">"Block Financial LLC"</span>,</span>
<span id="cb4-13"><a href=""></a>            <span class="st">"Carnival Corp"</span>, <span class="st">"Comcast Corp"</span>, <span class="st">"HP Inc"</span>, <span class="st">"MetLife Inc"</span>, <span class="st">"Xerox Corp"</span></span>
<span id="cb4-14"><a href=""></a>        ],</span>
<span id="cb4-15"><a href=""></a>        <span class="st">"CDS Ticker"</span>: [</span>
<span id="cb4-16"><a href=""></a>            <span class="st">"CNCP1U5 CBIN Curncy"</span>, <span class="st">"CALL1U5 CBIN Curncy"</span>, <span class="st">"CAPA1U5 CBIN Curncy"</span>, <span class="st">"CSBC1U5 CBIN Curncy"</span>,</span>
<span id="cb4-17"><a href=""></a>            <span class="st">"CHRB1U5 CBIN Curncy"</span>, <span class="st">"CCCL1U5 CBIN Curncy"</span>, <span class="st">"CT363688 CBIN Curncy"</span>, <span class="st">"CHWP1U5 CBIN Curncy"</span>,</span>
<span id="cb4-18"><a href=""></a>            <span class="st">"CMET1U5 CBIN Curncy"</span>, <span class="st">"CXRX1U5 CBIN Curncy"</span></span>
<span id="cb4-19"><a href=""></a>        ],</span>
<span id="cb4-20"><a href=""></a>        <span class="st">"PX_ASK"</span>: [<span class="fl">32.218</span>, <span class="fl">32.10185</span>, <span class="fl">132.8265</span>, <span class="fl">98.18737</span>, <span class="fl">108.3073</span>, <span class="fl">51.71049</span>, <span class="fl">46.48309</span>, <span class="fl">53.44293</span>, <span class="fl">72.10919</span>, <span class="fl">220.357</span>],</span>
<span id="cb4-21"><a href=""></a>        <span class="st">"PX_MID"</span>: [<span class="fl">29.79745</span>, <span class="fl">29.41297</span>, <span class="fl">127.8265</span>, <span class="fl">95.54818</span>, <span class="fl">102.5799</span>, <span class="fl">49.20801</span>, <span class="fl">43.89484</span>, <span class="fl">50.86313</span>, <span class="fl">69.5786</span>, <span class="fl">210.943</span>],</span>
<span id="cb4-22"><a href=""></a>        <span class="st">"PX_BID"</span>: [<span class="fl">27.37689</span>, <span class="fl">26.72408</span>, <span class="fl">122.8265</span>, <span class="fl">92.909</span>, <span class="fl">96.85262</span>, <span class="fl">46.70553</span>, <span class="fl">41.30658</span>, <span class="fl">48.28332</span>, <span class="fl">67.048</span>, <span class="fl">201.529</span>],</span>
<span id="cb4-23"><a href=""></a>        <span class="st">"Price Eqty Ticker"</span>: [</span>
<span id="cb4-24"><a href=""></a>            <span class="st">"FOXA US Equity"</span>, <span class="st">"ALL US Equity"</span>, <span class="st">"APA US Equity"</span>, <span class="st">"T US Equity"</span>, <span class="st">"HRB US Equity"</span>,</span>
<span id="cb4-25"><a href=""></a>            <span class="st">"CCL US Equity"</span>, <span class="st">"CMCSA US Equity"</span>, <span class="st">"HPQ US Equity"</span>, <span class="st">"MET US Equity"</span>, <span class="st">"XRX US Equity"</span></span>
<span id="cb4-26"><a href=""></a>        ],</span>
<span id="cb4-27"><a href=""></a>        <span class="st">"Eqty Price"</span>: [<span class="fl">50.44</span>, <span class="fl">94.07</span>, <span class="fl">33.00</span>, <span class="fl">30.419</span>, <span class="fl">24.07</span>, <span class="fl">58.24</span>, <span class="fl">37.8226</span>, <span class="fl">23.23</span>, <span class="fl">44.705</span>, <span class="fl">30.59</span>],</span>
<span id="cb4-28"><a href=""></a>        <span class="st">"6M"</span>: [<span class="fl">3.2</span>, <span class="fl">8.7</span>, <span class="fl">9.7</span>, <span class="dv">5</span>, <span class="fl">8.6</span>, <span class="fl">9.2</span>, <span class="fl">4.5</span>, <span class="fl">6.1</span>, <span class="fl">6.9</span>, <span class="fl">24.7</span>],</span>
<span id="cb4-29"><a href=""></a>        <span class="st">"1Y"</span>: [<span class="fl">5.3</span>, <span class="dv">13</span>, <span class="fl">15.9</span>, <span class="fl">6.7</span>, <span class="fl">13.1</span>, <span class="fl">10.3</span>, <span class="fl">8.8</span>, <span class="fl">9.4</span>, <span class="fl">10.9</span>, <span class="fl">32.1</span>],</span>
<span id="cb4-30"><a href=""></a>        <span class="st">"2Y"</span>: [<span class="fl">9.3</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="fl">9.8</span>, <span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">53</span>],</span>
<span id="cb4-31"><a href=""></a>        <span class="st">"3Y"</span>: [<span class="fl">14.5</span>, <span class="fl">43.7</span>, <span class="fl">33.6</span>, <span class="fl">15.2</span>, <span class="fl">44.6</span>, <span class="fl">26.5</span>, <span class="fl">22.6</span>, <span class="fl">30.8</span>, <span class="fl">34.5</span>, <span class="fl">89.5</span>],</span>
<span id="cb4-32"><a href=""></a>        <span class="st">"4Y"</span>: [<span class="fl">19.7</span>, <span class="fl">69.9</span>, <span class="dv">44</span>, <span class="dv">20</span>, <span class="fl">69.8</span>, <span class="fl">38.4</span>, <span class="fl">32.5</span>, <span class="fl">44.7</span>, <span class="fl">49.3</span>, <span class="fl">128.3</span>],</span>
<span id="cb4-33"><a href=""></a>        <span class="st">"5Y"</span>: [<span class="fl">30.4</span>, <span class="dv">109</span>, <span class="dv">54</span>, <span class="fl">27.5</span>, <span class="dv">106</span>, <span class="dv">49</span>, <span class="fl">46.3</span>, <span class="fl">65.5</span>, <span class="fl">66.3</span>, <span class="dv">221</span>],</span>
<span id="cb4-34"><a href=""></a>        <span class="st">"7Y"</span>: [<span class="fl">38.2</span>, <span class="fl">141.7</span>, <span class="fl">72.5</span>, <span class="fl">39.4</span>, <span class="fl">140.1</span>, <span class="fl">77.1</span>, <span class="dv">68</span>, <span class="fl">87.8</span>, <span class="fl">100.3</span>, <span class="fl">307.9</span>],</span>
<span id="cb4-35"><a href=""></a>        <span class="st">"10Y"</span>: [<span class="fl">45.1</span>, <span class="fl">170.3</span>, <span class="fl">87.9</span>, <span class="fl">48.7</span>, <span class="fl">158.9</span>, <span class="fl">90.9</span>, <span class="fl">82.7</span>, <span class="fl">108.5</span>, <span class="fl">119.1</span>, <span class="fl">343.6</span>]</span>
<span id="cb4-36"><a href=""></a>    }</span>
<span id="cb4-37"><a href=""></a></span>
<span id="cb4-38"><a href=""></a>    <span class="co"># Création du DataFrame</span></span>
<span id="cb4-39"><a href=""></a>    df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb4-40"><a href=""></a></span>
<span id="cb4-41"><a href=""></a>    <span class="co"># Sauvegarde au format CSV</span></span>
<span id="cb4-42"><a href=""></a>    df.to_csv(filename, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-43"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Fichier '</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">' créé avec succès."</span>)</span>
<span id="cb4-44"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb4-45"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Le fichier '</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">' existe déjà. Création non nécessaire."</span>)</span>
<span id="cb4-46"><a href=""></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="iii.-code" class="title-slide slide level1 center">
<h1>III. Code</h1>

</section>
<section id="a.-interpolation-linéaire" class="slide level2">
<h2>A. Interpolation linéaire</h2>
<ul>
<li>Interpolation linéaire : <span class="math inline">\(y = y_1 + \frac{(x - x_1)}{(x_2 - x_1)} \times (y_2 - y_1)\)</span></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a><span class="co">##### CODE #####</span></span>
<span id="cb5-2"><a href=""></a></span>
<span id="cb5-3"><a href=""></a><span class="kw">def</span> convert_maturity_to_float(maturity):</span>
<span id="cb5-4"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb5-5"><a href=""></a><span class="co"># Objectif : Convertir une maturité exprimée en chaîne de caractères ("1Y", "6M")</span></span>
<span id="cb5-6"><a href=""></a><span class="co">#            en un nombre flottant représentant le nombre d'années.</span></span>
<span id="cb5-7"><a href=""></a><span class="co">#            Exemple : "6M" devient 0.5 et "5Y" devient 5.0.</span></span>
<span id="cb5-8"><a href=""></a><span class="co"># Entrée : maturity (str ou float) - La maturité sous forme de chaîne ou de nombre.</span></span>
<span id="cb5-9"><a href=""></a><span class="co"># Sortie : float - La maturité exprimée en années (nombre flottant).</span></span>
<span id="cb5-10"><a href=""></a><span class="co"># ----------------------------------------------------------------------</span></span>
<span id="cb5-11"><a href=""></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(maturity, <span class="bu">str</span>):</span>
<span id="cb5-12"><a href=""></a>        <span class="cf">if</span> <span class="st">'Y'</span> <span class="kw">in</span> maturity:</span>
<span id="cb5-13"><a href=""></a>            <span class="cf">return</span> <span class="bu">float</span>(maturity.replace(<span class="st">'Y'</span>, <span class="st">''</span>))</span>
<span id="cb5-14"><a href=""></a>        <span class="cf">elif</span> <span class="st">'M'</span> <span class="kw">in</span> maturity:</span>
<span id="cb5-15"><a href=""></a>            <span class="cf">return</span> <span class="bu">float</span>(maturity.replace(<span class="st">'M'</span>, <span class="st">''</span>)) <span class="op">/</span> <span class="dv">12</span></span>
<span id="cb5-16"><a href=""></a>    <span class="cf">return</span> <span class="bu">float</span>(maturity)</span>
<span id="cb5-17"><a href=""></a></span>
<span id="cb5-18"><a href=""></a></span>
<span id="cb5-19"><a href=""></a><span class="kw">class</span> cMod_Curve:</span>
<span id="cb5-20"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb5-21"><a href=""></a><span class="co"># Objectif : Représente une courbe de taux (Risk-Free, Spread, Libor).</span></span>
<span id="cb5-22"><a href=""></a><span class="co">#             Elle stocke les paires (maturité, taux) sous forme d'un dictionnaire</span></span>
<span id="cb5-23"><a href=""></a><span class="co">#             et permet d'interpoler linéairement un taux pour une maturité donnée.</span></span>
<span id="cb5-24"><a href=""></a><span class="co">#</span></span>
<span id="cb5-25"><a href=""></a><span class="co"># Attributs :</span></span>
<span id="cb5-26"><a href=""></a><span class="co">#     - dict_Rates : dictionnaire {maturité (float) : taux (float)}</span></span>
<span id="cb5-27"><a href=""></a><span class="co">#</span></span>
<span id="cb5-28"><a href=""></a><span class="co"># Méthodes :</span></span>
<span id="cb5-29"><a href=""></a><span class="co">#     - set_rates(rates) : Remplit le dictionnaire de taux.</span></span>
<span id="cb5-30"><a href=""></a><span class="co">#     - fn_Interpolate(dbl_maturity) : </span></span>
<span id="cb5-31"><a href=""></a><span class="co">#           Renvoie le taux associé à une maturité donnée par interpolation linéaire.</span></span>
<span id="cb5-32"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb5-33"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb5-34"><a href=""></a>        <span class="va">self</span>.dict_Rates <span class="op">=</span> {}</span>
<span id="cb5-35"><a href=""></a></span>
<span id="cb5-36"><a href=""></a>    <span class="kw">def</span> set_rates(<span class="va">self</span>, rates):</span>
<span id="cb5-37"><a href=""></a>        <span class="va">self</span>.dict_Rates <span class="op">=</span> rates</span>
<span id="cb5-38"><a href=""></a></span>
<span id="cb5-39"><a href=""></a>    <span class="kw">def</span> fn_Interpolate(<span class="va">self</span>, dbl_maturity):</span>
<span id="cb5-40"><a href=""></a>        dbl_maturity <span class="op">=</span> <span class="bu">float</span>(dbl_maturity)</span>
<span id="cb5-41"><a href=""></a>        keys <span class="op">=</span> <span class="bu">sorted</span>(<span class="va">self</span>.dict_Rates.keys())</span>
<span id="cb5-42"><a href=""></a></span>
<span id="cb5-43"><a href=""></a>        <span class="cf">if</span> dbl_maturity <span class="kw">in</span> <span class="va">self</span>.dict_Rates:</span>
<span id="cb5-44"><a href=""></a>            <span class="cf">return</span> <span class="va">self</span>.dict_Rates[dbl_maturity]</span>
<span id="cb5-45"><a href=""></a></span>
<span id="cb5-46"><a href=""></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(keys)):</span>
<span id="cb5-47"><a href=""></a>            <span class="cf">if</span> keys[j] <span class="op">&gt;=</span> dbl_maturity:</span>
<span id="cb5-48"><a href=""></a>                <span class="cf">if</span> j <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-49"><a href=""></a>                    <span class="cf">return</span> <span class="va">self</span>.dict_Rates[keys[<span class="dv">0</span>]]</span>
<span id="cb5-50"><a href=""></a>                <span class="cf">else</span>:</span>
<span id="cb5-51"><a href=""></a>                    x1 <span class="op">=</span> keys[j<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-52"><a href=""></a>                    x2 <span class="op">=</span> keys[j]</span>
<span id="cb5-53"><a href=""></a>                    y1 <span class="op">=</span> <span class="va">self</span>.dict_Rates[x1]</span>
<span id="cb5-54"><a href=""></a>                    y2 <span class="op">=</span> <span class="va">self</span>.dict_Rates[x2]</span>
<span id="cb5-55"><a href=""></a>                    <span class="cf">return</span> y1 <span class="op">+</span> (dbl_maturity <span class="op">-</span> x1) <span class="op">*</span> (y2 <span class="op">-</span> y1) <span class="op">/</span> (x2 <span class="op">-</span> x1)</span>
<span id="cb5-56"><a href=""></a></span>
<span id="cb5-57"><a href=""></a>        <span class="cf">return</span> <span class="va">self</span>.dict_Rates[keys[<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb5-58"><a href=""></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="b.-prix-duration-et-calendrier-des-flux-de-trésorerie" class="slide level2">
<h2>B. Prix, duration et calendrier des flux de trésorerie</h2>
<p>Prix de l’obligation : <span class="math inline">\(P_0 = \sum_{t=1}^{T} \frac{c}{(1 + r_{f_t} + s_t)^t} + \frac{1}{(1 + r_{f_T} + s_T)^T}\)</span></p>
<p>Duration : <span class="math inline">\(D_0 = \frac{\sum_{t=1}^{T} \frac{t \times c}{(1 + r_{f_t} + s_t)^t} + \frac{T}{(1 + r_{f_T} + s_T)^T}}{P_0}\)</span></p>
<ul>
<li><span class="math inline">\(r_t\)</span> : taux sans risque à la date <span class="math inline">\(t\)</span> issu de la courbe souveraine interpolée</li>
<li><span class="math inline">\(s_t\)</span> : spread de crédit spécifique à l’émetteur à la date <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(c\)</span> : coupon payé périodiquement</li>
<li><span class="math inline">\(T\)</span> : maturité</li>
</ul>
</section>
<section id="b.-prix-duration-et-calendrier-des-flux-de-trésorerie-1" class="slide level2">
<h2>B. Prix, duration et calendrier des flux de trésorerie</h2>
<ul>
<li><p>Cashflow : <span class="math display">\[\text{CF}(t) =
\begin{cases}
\frac{c}{f} + 1, &amp; \text{si } t = T \\
\frac{c}{f}, &amp; \text{sinon}
\end{cases}
\]</span></p></li>
<li><p>Discounted Factor : <span class="math inline">\(\text{DF}(t) = \frac{1}{(1 + r_{f_t} + s_t)^t}\)</span></p></li>
<li><p>Discounted Cash Flow : <span class="math inline">\(\text{DCF}(t) = \text{CF}(t) \times \text{DF}(t)\)</span></p></li>
</ul>
</section>
<section id="b.-prix-duration-et-calendrier-des-flux-de-trésorerie-2" class="slide level2">
<h2>B. Prix, duration et calendrier des flux de trésorerie</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="kw">class</span> cMod_Bond:</span>
<span id="cb6-2"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb6-3"><a href=""></a><span class="co"># Objectif : Représente une obligation d'entreprise.</span></span>
<span id="cb6-4"><a href=""></a><span class="co">#             Cette classe permet de calculer :</span></span>
<span id="cb6-5"><a href=""></a><span class="co">#             - Le prix de l'obligation (en actualisant les flux futurs)</span></span>
<span id="cb6-6"><a href=""></a><span class="co">#             - La duration (sensibilité du prix à une variation des taux)</span></span>
<span id="cb6-7"><a href=""></a><span class="co">#             - Le calendrier des flux de trésorerie ("schedule")</span></span>
<span id="cb6-8"><a href=""></a><span class="co">#</span></span>
<span id="cb6-9"><a href=""></a><span class="co"># Attributs :</span></span>
<span id="cb6-10"><a href=""></a><span class="co">#     - issuer : Nom de l'émetteur</span></span>
<span id="cb6-11"><a href=""></a><span class="co">#     - coupon_rate : Taux facial du coupon</span></span>
<span id="cb6-12"><a href=""></a><span class="co">#     - margin : Marge pour les coupons variables</span></span>
<span id="cb6-13"><a href=""></a><span class="co">#     - coupon_type : "Fixed" ou "Variable"</span></span>
<span id="cb6-14"><a href=""></a><span class="co">#     - coupon_frequency : "Annual", "Semi-Annual" ou "Quarterly"</span></span>
<span id="cb6-15"><a href=""></a><span class="co">#     - maturity : Maturité de l'obligation (en années)</span></span>
<span id="cb6-16"><a href=""></a><span class="co">#     - spread, obj_RFRate, obj_Spread, obj_LiborCurve : courbes de taux utilisées</span></span>
<span id="cb6-17"><a href=""></a><span class="co">#</span></span>
<span id="cb6-18"><a href=""></a><span class="co"># Méthodes principales :</span></span>
<span id="cb6-19"><a href=""></a><span class="co">#     - get_coupon_frequency_value() : Renvoie la fréquence de paiement sous forme numérique (1, 2, 4)</span></span>
<span id="cb6-20"><a href=""></a><span class="co">#     - fn_FirstCouponPaymentDate() : Calcule la première date de paiement du coupon</span></span>
<span id="cb6-21"><a href=""></a><span class="co">#     - fn_price() : Calcule le prix de l'obligation (% du nominal)</span></span>
<span id="cb6-22"><a href=""></a><span class="co">#     - fn_duration() : Calcule la duration de l'obligation</span></span>
<span id="cb6-23"><a href=""></a><span class="co">#     - get_schedule() : Génère l'échéancier des flux de trésorerie</span></span>
<span id="cb6-24"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb6-25"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, issuer, coupon_rate, margin, coupon_type, coupon_frequency, maturity, spread, rf_curve, spread_curve, libor_curve):</span>
<span id="cb6-26"><a href=""></a>        <span class="va">self</span>.issuer <span class="op">=</span> issuer</span>
<span id="cb6-27"><a href=""></a>        <span class="va">self</span>.coupon_rate <span class="op">=</span> coupon_rate</span>
<span id="cb6-28"><a href=""></a>        <span class="va">self</span>.margin <span class="op">=</span> margin</span>
<span id="cb6-29"><a href=""></a>        <span class="va">self</span>.coupon_type <span class="op">=</span> coupon_type</span>
<span id="cb6-30"><a href=""></a>        <span class="va">self</span>.coupon_frequency <span class="op">=</span> coupon_frequency</span>
<span id="cb6-31"><a href=""></a>        <span class="va">self</span>.maturity <span class="op">=</span> maturity</span>
<span id="cb6-32"><a href=""></a>        <span class="va">self</span>.spread <span class="op">=</span> spread</span>
<span id="cb6-33"><a href=""></a>        <span class="va">self</span>.obj_RFRate <span class="op">=</span> rf_curve</span>
<span id="cb6-34"><a href=""></a>        <span class="va">self</span>.obj_Spread <span class="op">=</span> spread_curve</span>
<span id="cb6-35"><a href=""></a>        <span class="va">self</span>.obj_LiborCurve <span class="op">=</span> libor_curve</span>
<span id="cb6-36"><a href=""></a></span>
<span id="cb6-37"><a href=""></a>    <span class="kw">def</span> get_coupon_frequency_value(<span class="va">self</span>):</span>
<span id="cb6-38"><a href=""></a>        <span class="cf">if</span> <span class="va">self</span>.coupon_frequency <span class="op">==</span> <span class="st">"Annual"</span>:</span>
<span id="cb6-39"><a href=""></a>            <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb6-40"><a href=""></a>        <span class="cf">elif</span> <span class="va">self</span>.coupon_frequency <span class="op">==</span> <span class="st">"Semi-Annual"</span>:</span>
<span id="cb6-41"><a href=""></a>            <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb6-42"><a href=""></a>        <span class="cf">elif</span> <span class="va">self</span>.coupon_frequency <span class="op">==</span> <span class="st">"Quarterly"</span>:</span>
<span id="cb6-43"><a href=""></a>            <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb6-44"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb6-45"><a href=""></a>            <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb6-46"><a href=""></a></span>
<span id="cb6-47"><a href=""></a>    <span class="kw">def</span> fn_FirstCouponPaymentDate(<span class="va">self</span>):</span>
<span id="cb6-48"><a href=""></a>        <span class="cf">if</span> <span class="va">self</span>.maturity <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb6-49"><a href=""></a>            <span class="va">self</span>.maturity <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-50"><a href=""></a>        first_coupon <span class="op">=</span> <span class="va">self</span>.maturity <span class="op">-</span> <span class="bu">int</span>(<span class="va">self</span>.maturity)</span>
<span id="cb6-51"><a href=""></a>        freq <span class="op">=</span> <span class="va">self</span>.get_coupon_frequency_value()</span>
<span id="cb6-52"><a href=""></a></span>
<span id="cb6-53"><a href=""></a>        <span class="cf">if</span> freq <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb6-54"><a href=""></a>            first_coupon <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-55"><a href=""></a>        <span class="cf">elif</span> freq <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb6-56"><a href=""></a>            first_coupon <span class="op">+=</span> <span class="fl">0.5</span></span>
<span id="cb6-57"><a href=""></a>        <span class="cf">elif</span> freq <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb6-58"><a href=""></a>            first_coupon <span class="op">+=</span> <span class="fl">0.25</span></span>
<span id="cb6-59"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb6-60"><a href=""></a>            first_coupon <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-61"><a href=""></a></span>
<span id="cb6-62"><a href=""></a>        <span class="cf">return</span> first_coupon</span>
<span id="cb6-63"><a href=""></a></span>
<span id="cb6-64"><a href=""></a>    <span class="kw">def</span> fn_price(<span class="va">self</span>):</span>
<span id="cb6-65"><a href=""></a>        total_price <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-66"><a href=""></a>        coupon_freq <span class="op">=</span> <span class="va">self</span>.get_coupon_frequency_value()</span>
<span id="cb6-67"><a href=""></a>        first_coupon_date <span class="op">=</span> <span class="va">self</span>.fn_FirstCouponPaymentDate()</span>
<span id="cb6-68"><a href=""></a></span>
<span id="cb6-69"><a href=""></a>        <span class="cf">for</span> t <span class="kw">in</span> np.arange(first_coupon_date, <span class="va">self</span>.maturity <span class="op">+</span> <span class="fl">1e-8</span>, <span class="dv">1</span> <span class="op">/</span> coupon_freq):</span>
<span id="cb6-70"><a href=""></a>            rf_rate <span class="op">=</span> <span class="va">self</span>.obj_RFRate.fn_Interpolate(t)</span>
<span id="cb6-71"><a href=""></a>            spread <span class="op">=</span> <span class="va">self</span>.obj_Spread.fn_Interpolate(t)</span>
<span id="cb6-72"><a href=""></a></span>
<span id="cb6-73"><a href=""></a>            <span class="cf">if</span> <span class="va">self</span>.coupon_type <span class="op">==</span> <span class="st">"Fixed"</span>:</span>
<span id="cb6-74"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.coupon_rate</span>
<span id="cb6-75"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-76"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.obj_LiborCurve.fn_Interpolate(t) <span class="op">+</span> <span class="va">self</span>.margin</span>
<span id="cb6-77"><a href=""></a></span>
<span id="cb6-78"><a href=""></a>            <span class="cf">if</span> np.isclose(t, <span class="va">self</span>.maturity):</span>
<span id="cb6-79"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-80"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-81"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq</span>
<span id="cb6-82"><a href=""></a></span>
<span id="cb6-83"><a href=""></a>            total_price <span class="op">+=</span> cash_flow <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> rf_rate <span class="op">+</span> spread) <span class="op">**</span> <span class="op">-</span>t</span>
<span id="cb6-84"><a href=""></a></span>
<span id="cb6-85"><a href=""></a>        <span class="cf">return</span> total_price <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb6-86"><a href=""></a></span>
<span id="cb6-87"><a href=""></a>    <span class="kw">def</span> fn_duration(<span class="va">self</span>):</span>
<span id="cb6-88"><a href=""></a>        weighted_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-89"><a href=""></a>        bond_price <span class="op">=</span> <span class="va">self</span>.fn_price() <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb6-90"><a href=""></a>        coupon_freq <span class="op">=</span> <span class="va">self</span>.get_coupon_frequency_value()</span>
<span id="cb6-91"><a href=""></a>        first_coupon_date <span class="op">=</span> <span class="va">self</span>.fn_FirstCouponPaymentDate()</span>
<span id="cb6-92"><a href=""></a></span>
<span id="cb6-93"><a href=""></a>        <span class="cf">for</span> t <span class="kw">in</span> np.arange(first_coupon_date, <span class="va">self</span>.maturity <span class="op">+</span> <span class="fl">1e-8</span>, <span class="dv">1</span> <span class="op">/</span> coupon_freq):</span>
<span id="cb6-94"><a href=""></a>            rf_rate <span class="op">=</span> <span class="va">self</span>.obj_RFRate.fn_Interpolate(t)</span>
<span id="cb6-95"><a href=""></a>            spread <span class="op">=</span> <span class="va">self</span>.obj_Spread.fn_Interpolate(t)</span>
<span id="cb6-96"><a href=""></a></span>
<span id="cb6-97"><a href=""></a>            <span class="cf">if</span> <span class="va">self</span>.coupon_type <span class="op">==</span> <span class="st">"Fixed"</span>:</span>
<span id="cb6-98"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.coupon_rate</span>
<span id="cb6-99"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-100"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.obj_LiborCurve.fn_Interpolate(t) <span class="op">+</span> <span class="va">self</span>.margin</span>
<span id="cb6-101"><a href=""></a></span>
<span id="cb6-102"><a href=""></a>            <span class="cf">if</span> np.isclose(t, <span class="va">self</span>.maturity):</span>
<span id="cb6-103"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-104"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-105"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq</span>
<span id="cb6-106"><a href=""></a></span>
<span id="cb6-107"><a href=""></a>            weighted_sum <span class="op">+=</span> (cash_flow <span class="op">*</span> t) <span class="op">/</span> ((<span class="dv">1</span> <span class="op">+</span> rf_rate <span class="op">+</span> spread) <span class="op">**</span> t)</span>
<span id="cb6-108"><a href=""></a></span>
<span id="cb6-109"><a href=""></a>        <span class="cf">return</span> weighted_sum <span class="op">/</span> bond_price</span>
<span id="cb6-110"><a href=""></a></span>
<span id="cb6-111"><a href=""></a>    <span class="kw">def</span> get_schedule(<span class="va">self</span>):</span>
<span id="cb6-112"><a href=""></a>        schedule_data <span class="op">=</span> []</span>
<span id="cb6-113"><a href=""></a>        first_coupon_date <span class="op">=</span> <span class="va">self</span>.fn_FirstCouponPaymentDate()</span>
<span id="cb6-114"><a href=""></a>        coupon_freq <span class="op">=</span> <span class="va">self</span>.get_coupon_frequency_value()</span>
<span id="cb6-115"><a href=""></a></span>
<span id="cb6-116"><a href=""></a>        <span class="cf">for</span> t <span class="kw">in</span> np.arange(first_coupon_date, <span class="va">self</span>.maturity <span class="op">+</span> <span class="fl">1e-8</span>, <span class="dv">1</span> <span class="op">/</span> coupon_freq):</span>
<span id="cb6-117"><a href=""></a>            rf_rate <span class="op">=</span> <span class="va">self</span>.obj_RFRate.fn_Interpolate(t)</span>
<span id="cb6-118"><a href=""></a>            spread <span class="op">=</span> <span class="va">self</span>.obj_Spread.fn_Interpolate(t)</span>
<span id="cb6-119"><a href=""></a></span>
<span id="cb6-120"><a href=""></a>            <span class="cf">if</span> <span class="va">self</span>.coupon_type <span class="op">==</span> <span class="st">"Fixed"</span>:</span>
<span id="cb6-121"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.coupon_rate</span>
<span id="cb6-122"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-123"><a href=""></a>                coupon_rate <span class="op">=</span> <span class="va">self</span>.obj_LiborCurve.fn_Interpolate(t) <span class="op">+</span> <span class="va">self</span>.margin</span>
<span id="cb6-124"><a href=""></a></span>
<span id="cb6-125"><a href=""></a>            <span class="cf">if</span> np.isclose(t, <span class="va">self</span>.maturity):</span>
<span id="cb6-126"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-127"><a href=""></a>            <span class="cf">else</span>:</span>
<span id="cb6-128"><a href=""></a>                cash_flow <span class="op">=</span> coupon_rate <span class="op">/</span> coupon_freq</span>
<span id="cb6-129"><a href=""></a></span>
<span id="cb6-130"><a href=""></a>            discount_factor <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> rf_rate <span class="op">+</span> spread) <span class="op">**</span> <span class="op">-</span>t</span>
<span id="cb6-131"><a href=""></a>            discounted_cash_flow <span class="op">=</span> cash_flow <span class="op">*</span> discount_factor</span>
<span id="cb6-132"><a href=""></a></span>
<span id="cb6-133"><a href=""></a>            schedule_data.append({</span>
<span id="cb6-134"><a href=""></a>                <span class="st">'Date'</span>: <span class="bu">round</span>(t, <span class="dv">6</span>),</span>
<span id="cb6-135"><a href=""></a>                <span class="st">'Cash Flow'</span>: <span class="ss">f"</span><span class="sc">{</span>cash_flow <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span>,</span>
<span id="cb6-136"><a href=""></a>                <span class="st">'Risk Free Rate'</span>: <span class="ss">f"</span><span class="sc">{</span>rf_rate <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span>,</span>
<span id="cb6-137"><a href=""></a>                <span class="st">'Spread'</span>: <span class="ss">f"</span><span class="sc">{</span>spread <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span>,</span>
<span id="cb6-138"><a href=""></a>                <span class="st">'Discount Factor'</span>: <span class="ss">f"</span><span class="sc">{</span>discount_factor <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span>,</span>
<span id="cb6-139"><a href=""></a>                <span class="st">'Discounted Cash Flow'</span>: <span class="ss">f"</span><span class="sc">{</span>discounted_cash_flow <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span></span>
<span id="cb6-140"><a href=""></a>            })</span>
<span id="cb6-141"><a href=""></a></span>
<span id="cb6-142"><a href=""></a>        <span class="cf">return</span> pd.DataFrame(schedule_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="c.-notre-outil-le-pricer" class="slide level2">
<h2>C. Notre outil : le pricer</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="kw">def</span> load_data():</span>
<span id="cb7-2"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-3"><a href=""></a><span class="co"># Objectif : Charger les données de taux depuis les fichiers CSV :</span></span>
<span id="cb7-4"><a href=""></a><span class="co">#             - Libor 3M interpolé</span></span>
<span id="cb7-5"><a href=""></a><span class="co">#             - US Yield Curve</span></span>
<span id="cb7-6"><a href=""></a><span class="co">#             - CDX IG Prices (spreads)</span></span>
<span id="cb7-7"><a href=""></a><span class="co"># Retourne :</span></span>
<span id="cb7-8"><a href=""></a><span class="co">#     - dict_LIBOR3M : Dictionnaire des taux Libor 3M</span></span>
<span id="cb7-9"><a href=""></a><span class="co">#     - dict_US_YIELD_CURVE : Dictionnaire des taux US Risk-Free</span></span>
<span id="cb7-10"><a href=""></a><span class="co">#     - cdx_ig_prices : Table complète des spreads par entreprise</span></span>
<span id="cb7-11"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-12"><a href=""></a>    libor_curve <span class="op">=</span> pd.read_csv(<span class="st">'euribor_rates_interpolated.csv'</span>)</span>
<span id="cb7-13"><a href=""></a>    us_yield_curve <span class="op">=</span> pd.read_csv(<span class="st">'US_Yield_Curve.csv'</span>)</span>
<span id="cb7-14"><a href=""></a>    cdx_ig_prices <span class="op">=</span> pd.read_csv(<span class="st">'CDX_IG_Prices.csv'</span>)</span>
<span id="cb7-15"><a href=""></a></span>
<span id="cb7-16"><a href=""></a>    dict_LIBOR3M <span class="op">=</span> {convert_maturity_to_float(maturity): rate <span class="op">/</span> <span class="dv">100</span> <span class="cf">for</span> maturity, rate <span class="kw">in</span> <span class="bu">zip</span>(libor_curve[<span class="st">'Maturity'</span>], libor_curve[<span class="st">'Interpolated_Rate_2025'</span>])}</span>
<span id="cb7-17"><a href=""></a>    dict_US_YIELD_CURVE <span class="op">=</span> {convert_maturity_to_float(maturity): rate <span class="op">/</span> <span class="dv">100</span> <span class="cf">for</span> maturity, rate <span class="kw">in</span> <span class="bu">zip</span>(us_yield_curve[<span class="st">'Maturity'</span>], us_yield_curve[<span class="st">'Rate'</span>])}</span>
<span id="cb7-18"><a href=""></a></span>
<span id="cb7-19"><a href=""></a>    <span class="cf">return</span> dict_LIBOR3M, dict_US_YIELD_CURVE, cdx_ig_prices</span>
<span id="cb7-20"><a href=""></a></span>
<span id="cb7-21"><a href=""></a></span>
<span id="cb7-22"><a href=""></a><span class="kw">def</span> sub_pricer(issuer, coupon_rate, margin, coupon_type, coupon_frequency, maturity):</span>
<span id="cb7-23"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-24"><a href=""></a><span class="co"># Objectif : </span></span>
<span id="cb7-25"><a href=""></a><span class="co">#     - Créer les objets de courbes (Libor, Risk-Free, Spread) selon l'émetteur sélectionné</span></span>
<span id="cb7-26"><a href=""></a><span class="co">#     - Instancier l'obligation</span></span>
<span id="cb7-27"><a href=""></a><span class="co">#     - Calculer le prix, la duration et générer l'échéancier des cash flows</span></span>
<span id="cb7-28"><a href=""></a><span class="co"># Entrées :</span></span>
<span id="cb7-29"><a href=""></a><span class="co">#     - issuer : entreprise sélectionnée</span></span>
<span id="cb7-30"><a href=""></a><span class="co">#     - coupon_rate : taux du coupon</span></span>
<span id="cb7-31"><a href=""></a><span class="co">#     - margin : marge si coupon variable</span></span>
<span id="cb7-32"><a href=""></a><span class="co">#     - coupon_type : "Fixed" ou "Variable"</span></span>
<span id="cb7-33"><a href=""></a><span class="co">#     - coupon_frequency : "Annual", "Semi-Annual", "Quarterly"</span></span>
<span id="cb7-34"><a href=""></a><span class="co">#     - maturity : maturité de l'obligation</span></span>
<span id="cb7-35"><a href=""></a><span class="co"># Retourne :</span></span>
<span id="cb7-36"><a href=""></a><span class="co">#     - price : prix de l'obligation (% du nominal)</span></span>
<span id="cb7-37"><a href=""></a><span class="co">#     - duration : duration de l'obligation (en années)</span></span>
<span id="cb7-38"><a href=""></a><span class="co">#     - schedule : DataFrame avec le calendrier des flux</span></span>
<span id="cb7-39"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb7-40"><a href=""></a>    dict_LIBOR3M, dict_US_YIELD_CURVE, cdx_ig_prices <span class="op">=</span> load_data()</span>
<span id="cb7-41"><a href=""></a></span>
<span id="cb7-42"><a href=""></a>    issuer_row <span class="op">=</span> cdx_ig_prices[cdx_ig_prices[<span class="st">'Name'</span>] <span class="op">==</span> issuer]</span>
<span id="cb7-43"><a href=""></a>    <span class="cf">if</span> issuer_row.empty:</span>
<span id="cb7-44"><a href=""></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"Issuer </span><span class="sc">{</span>issuer<span class="sc">}</span><span class="ss"> not found in CDX_IG_Prices.csv"</span>)</span>
<span id="cb7-45"><a href=""></a></span>
<span id="cb7-46"><a href=""></a>    dict_Spreads <span class="op">=</span> {</span>
<span id="cb7-47"><a href=""></a>        convert_maturity_to_float(<span class="st">'0.5Y'</span>): issuer_row[<span class="st">'6M'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-48"><a href=""></a>        convert_maturity_to_float(<span class="st">'1Y'</span>): issuer_row[<span class="st">'1Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-49"><a href=""></a>        convert_maturity_to_float(<span class="st">'2Y'</span>): issuer_row[<span class="st">'2Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-50"><a href=""></a>        convert_maturity_to_float(<span class="st">'3Y'</span>): issuer_row[<span class="st">'3Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-51"><a href=""></a>        convert_maturity_to_float(<span class="st">'4Y'</span>): issuer_row[<span class="st">'4Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-52"><a href=""></a>        convert_maturity_to_float(<span class="st">'5Y'</span>): issuer_row[<span class="st">'5Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-53"><a href=""></a>        convert_maturity_to_float(<span class="st">'7Y'</span>): issuer_row[<span class="st">'7Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span>,</span>
<span id="cb7-54"><a href=""></a>        convert_maturity_to_float(<span class="st">'10Y'</span>): issuer_row[<span class="st">'10Y'</span>].values[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">10000</span></span>
<span id="cb7-55"><a href=""></a>    }</span>
<span id="cb7-56"><a href=""></a></span>
<span id="cb7-57"><a href=""></a>    obj_LIBOR3M <span class="op">=</span> cMod_Curve()</span>
<span id="cb7-58"><a href=""></a>    obj_US_YIELD_CURVE <span class="op">=</span> cMod_Curve()</span>
<span id="cb7-59"><a href=""></a>    obj_Spread <span class="op">=</span> cMod_Curve()</span>
<span id="cb7-60"><a href=""></a></span>
<span id="cb7-61"><a href=""></a>    obj_LIBOR3M.set_rates(dict_LIBOR3M)</span>
<span id="cb7-62"><a href=""></a>    obj_US_YIELD_CURVE.set_rates(dict_US_YIELD_CURVE)</span>
<span id="cb7-63"><a href=""></a>    obj_Spread.set_rates(dict_Spreads)</span>
<span id="cb7-64"><a href=""></a></span>
<span id="cb7-65"><a href=""></a>    company_bond <span class="op">=</span> cMod_Bond(</span>
<span id="cb7-66"><a href=""></a>        issuer, coupon_rate, margin, coupon_type, coupon_frequency, maturity,</span>
<span id="cb7-67"><a href=""></a>        obj_Spread, obj_US_YIELD_CURVE, obj_Spread, obj_LIBOR3M</span>
<span id="cb7-68"><a href=""></a>    )</span>
<span id="cb7-69"><a href=""></a></span>
<span id="cb7-70"><a href=""></a>    price <span class="op">=</span> company_bond.fn_price()</span>
<span id="cb7-71"><a href=""></a>    duration <span class="op">=</span> company_bond.fn_duration()</span>
<span id="cb7-72"><a href=""></a>    schedule <span class="op">=</span> company_bond.get_schedule()</span>
<span id="cb7-73"><a href=""></a></span>
<span id="cb7-74"><a href=""></a>    <span class="cf">return</span> price, duration, schedule</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="d.-linterface-du-pricer" class="slide level2">
<h2>D. L’interface du pricer</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="kw">def</span> run_interface():</span>
<span id="cb8-2"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb8-3"><a href=""></a><span class="co"># Fonction : run_interface()</span></span>
<span id="cb8-4"><a href=""></a><span class="co"># Objectif : Lancer une interface graphique Tkinter pour permettre à l'utilisateur de :</span></span>
<span id="cb8-5"><a href=""></a><span class="co">#             - Choisir les paramètres de l'obligation (émetteur, taux, maturité, etc.)</span></span>
<span id="cb8-6"><a href=""></a><span class="co">#             - Calculer le prix et la duration</span></span>
<span id="cb8-7"><a href=""></a><span class="co">#             - Afficher dynamiquement le calendrier de flux</span></span>
<span id="cb8-8"><a href=""></a><span class="co"># Résultat : L'interface Tkinter est lancée et interactive</span></span>
<span id="cb8-9"><a href=""></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb8-10"><a href=""></a>    <span class="kw">def</span> calculate():</span>
<span id="cb8-11"><a href=""></a>    <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb8-12"><a href=""></a>    <span class="co"># Fonction interne : calculate()</span></span>
<span id="cb8-13"><a href=""></a>    <span class="co"># Objectif : (Appelée par le bouton Tkinter)</span></span>
<span id="cb8-14"><a href=""></a>    <span class="co">#             - Récupérer les inputs utilisateur</span></span>
<span id="cb8-15"><a href=""></a>    <span class="co">#             - Lancer le pricer</span></span>
<span id="cb8-16"><a href=""></a>    <span class="co">#             - Afficher le prix, la duration et le calendrier dans l'interface</span></span>
<span id="cb8-17"><a href=""></a>    <span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb8-18"><a href=""></a>        <span class="cf">try</span>:</span>
<span id="cb8-19"><a href=""></a>            <span class="co"># Clear the Treeview</span></span>
<span id="cb8-20"><a href=""></a>            <span class="cf">for</span> item <span class="kw">in</span> schedule_tree.get_children():</span>
<span id="cb8-21"><a href=""></a>                schedule_tree.delete(item)</span>
<span id="cb8-22"><a href=""></a></span>
<span id="cb8-23"><a href=""></a>            <span class="co"># Retrieve user inputs</span></span>
<span id="cb8-24"><a href=""></a>            issuer <span class="op">=</span> issuer_combo.get()</span>
<span id="cb8-25"><a href=""></a>            coupon_type <span class="op">=</span> type_combo.get()</span>
<span id="cb8-26"><a href=""></a>            coupon_frequency <span class="op">=</span> freq_combo.get()</span>
<span id="cb8-27"><a href=""></a>            coupon_rate <span class="op">=</span> <span class="bu">float</span>(coupon_rate_entry.get())</span>
<span id="cb8-28"><a href=""></a>            margin <span class="op">=</span> <span class="bu">float</span>(margin_entry.get())</span>
<span id="cb8-29"><a href=""></a>            maturity <span class="op">=</span> <span class="bu">float</span>(maturity_entry.get())</span>
<span id="cb8-30"><a href=""></a></span>
<span id="cb8-31"><a href=""></a>            <span class="co"># Pricing</span></span>
<span id="cb8-32"><a href=""></a>            price, duration, schedule_df <span class="op">=</span> sub_pricer(</span>
<span id="cb8-33"><a href=""></a>                issuer, coupon_rate, margin, coupon_type, coupon_frequency, maturity</span>
<span id="cb8-34"><a href=""></a>            )</span>
<span id="cb8-35"><a href=""></a></span>
<span id="cb8-36"><a href=""></a>            <span class="co"># Display Price and Duration</span></span>
<span id="cb8-37"><a href=""></a>            result_label.config(text<span class="op">=</span><span class="ss">f"Price: </span><span class="sc">{</span><span class="bu">round</span>(price, <span class="dv">6</span>)<span class="sc">}</span><span class="ss"> %</span><span class="ch">\n</span><span class="ss">Duration: </span><span class="sc">{</span><span class="bu">round</span>(duration, <span class="dv">6</span>)<span class="sc">}</span><span class="ss"> years"</span>)</span>
<span id="cb8-38"><a href=""></a></span>
<span id="cb8-39"><a href=""></a>            <span class="co"># Fill Treeview with Schedule</span></span>
<span id="cb8-40"><a href=""></a>            <span class="cf">for</span> _, row <span class="kw">in</span> schedule_df.iterrows():</span>
<span id="cb8-41"><a href=""></a>                schedule_tree.insert(<span class="st">''</span>, <span class="st">'end'</span>, values<span class="op">=</span><span class="bu">list</span>(row))</span>
<span id="cb8-42"><a href=""></a></span>
<span id="cb8-43"><a href=""></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-44"><a href=""></a>            messagebox.showerror(<span class="st">"Error"</span>, <span class="bu">str</span>(e))</span>
<span id="cb8-45"><a href=""></a></span>
<span id="cb8-46"><a href=""></a>    window <span class="op">=</span> tk.Tk()</span>
<span id="cb8-47"><a href=""></a>    window.title(<span class="st">"Corporate Bond Pricer"</span>)</span>
<span id="cb8-48"><a href=""></a></span>
<span id="cb8-49"><a href=""></a>    <span class="co"># List values</span></span>
<span id="cb8-50"><a href=""></a>    list_issuers <span class="op">=</span> [</span>
<span id="cb8-51"><a href=""></a>        <span class="st">"21st Century Fox America Inc"</span>, <span class="st">"Allstate Corp/The"</span>, <span class="st">"Apache Corp"</span>, <span class="st">"AT&amp;T Inc"</span>,</span>
<span id="cb8-52"><a href=""></a>        <span class="st">"Block Financial LLC"</span>, <span class="st">"Carnival Corp"</span>, <span class="st">"Comcast Corp"</span>, <span class="st">"HP Inc"</span>, <span class="st">"MetLife Inc"</span>, <span class="st">"Xerox Corp"</span></span>
<span id="cb8-53"><a href=""></a>    ]</span>
<span id="cb8-54"><a href=""></a>    list_coupon_types <span class="op">=</span> [<span class="st">"Fixed"</span>, <span class="st">"Variable"</span>]</span>
<span id="cb8-55"><a href=""></a>    list_coupon_frequencies <span class="op">=</span> [<span class="st">"Annual"</span>, <span class="st">"Semi-Annual"</span>, <span class="st">"Quarterly"</span>]</span>
<span id="cb8-56"><a href=""></a></span>
<span id="cb8-57"><a href=""></a>    <span class="co"># Inputs</span></span>
<span id="cb8-58"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Issuer"</span>).pack()</span>
<span id="cb8-59"><a href=""></a>    issuer_combo <span class="op">=</span> ttk.Combobox(window, values<span class="op">=</span>list_issuers, width<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb8-60"><a href=""></a>    issuer_combo.pack()</span>
<span id="cb8-61"><a href=""></a></span>
<span id="cb8-62"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Coupon Type"</span>).pack()</span>
<span id="cb8-63"><a href=""></a>    type_combo <span class="op">=</span> ttk.Combobox(window, values<span class="op">=</span>list_coupon_types)</span>
<span id="cb8-64"><a href=""></a>    type_combo.pack()</span>
<span id="cb8-65"><a href=""></a></span>
<span id="cb8-66"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Coupon Frequency"</span>).pack()</span>
<span id="cb8-67"><a href=""></a>    freq_combo <span class="op">=</span> ttk.Combobox(window, values<span class="op">=</span>list_coupon_frequencies)</span>
<span id="cb8-68"><a href=""></a>    freq_combo.pack()</span>
<span id="cb8-69"><a href=""></a></span>
<span id="cb8-70"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Coupon Rate (e.g., 0.05)"</span>).pack()</span>
<span id="cb8-71"><a href=""></a>    coupon_rate_entry <span class="op">=</span> tk.Entry(window)</span>
<span id="cb8-72"><a href=""></a>    coupon_rate_entry.pack()</span>
<span id="cb8-73"><a href=""></a></span>
<span id="cb8-74"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Margin (if Variable, else 0)"</span>).pack()</span>
<span id="cb8-75"><a href=""></a>    margin_entry <span class="op">=</span> tk.Entry(window)</span>
<span id="cb8-76"><a href=""></a>    margin_entry.pack()</span>
<span id="cb8-77"><a href=""></a></span>
<span id="cb8-78"><a href=""></a>    tk.Label(window, text<span class="op">=</span><span class="st">"Maturity (e.g., 5.5)"</span>).pack()</span>
<span id="cb8-79"><a href=""></a>    maturity_entry <span class="op">=</span> tk.Entry(window)</span>
<span id="cb8-80"><a href=""></a>    maturity_entry.pack()</span>
<span id="cb8-81"><a href=""></a></span>
<span id="cb8-82"><a href=""></a>    <span class="co"># Button</span></span>
<span id="cb8-83"><a href=""></a>    tk.Button(window, text<span class="op">=</span><span class="st">"Calculate"</span>, command<span class="op">=</span>calculate).pack(pady<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-84"><a href=""></a></span>
<span id="cb8-85"><a href=""></a>    <span class="co"># Results</span></span>
<span id="cb8-86"><a href=""></a>    result_label <span class="op">=</span> tk.Label(window, text<span class="op">=</span><span class="st">""</span>, font<span class="op">=</span>(<span class="st">"Arial"</span>, <span class="dv">12</span>))</span>
<span id="cb8-87"><a href=""></a>    result_label.pack()</span>
<span id="cb8-88"><a href=""></a></span>
<span id="cb8-89"><a href=""></a>    <span class="co"># Schedule Table</span></span>
<span id="cb8-90"><a href=""></a>    schedule_frame <span class="op">=</span> tk.Frame(window)</span>
<span id="cb8-91"><a href=""></a>    schedule_frame.pack(pady<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-92"><a href=""></a></span>
<span id="cb8-93"><a href=""></a>    schedule_tree <span class="op">=</span> ttk.Treeview(schedule_frame, columns<span class="op">=</span>(<span class="st">"Date"</span>, <span class="st">"Cash Flow"</span>, <span class="st">"Risk Free Rate"</span>, <span class="st">"Spread"</span>, <span class="st">"Discount Factor"</span>, <span class="st">"Discounted Cash Flow"</span>), show<span class="op">=</span><span class="st">"headings"</span>)</span>
<span id="cb8-94"><a href=""></a>    schedule_tree.pack(side<span class="op">=</span><span class="st">"left"</span>, fill<span class="op">=</span><span class="st">"both"</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-95"><a href=""></a></span>
<span id="cb8-96"><a href=""></a>    <span class="cf">for</span> col <span class="kw">in</span> schedule_tree[<span class="st">"columns"</span>]:</span>
<span id="cb8-97"><a href=""></a>        schedule_tree.heading(col, text<span class="op">=</span>col)</span>
<span id="cb8-98"><a href=""></a>        schedule_tree.column(col, anchor<span class="op">=</span><span class="st">"center"</span>, width<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb8-99"><a href=""></a></span>
<span id="cb8-100"><a href=""></a>    scrollbar <span class="op">=</span> ttk.Scrollbar(schedule_frame, orient<span class="op">=</span><span class="st">"vertical"</span>, command<span class="op">=</span>schedule_tree.yview)</span>
<span id="cb8-101"><a href=""></a>    schedule_tree.configure(yscrollcommand<span class="op">=</span>scrollbar.<span class="bu">set</span>)</span>
<span id="cb8-102"><a href=""></a>    scrollbar.pack(side<span class="op">=</span><span class="st">"right"</span>, fill<span class="op">=</span><span class="st">"y"</span>)</span>
<span id="cb8-103"><a href=""></a></span>
<span id="cb8-104"><a href=""></a>    window.mainloop()</span>
<span id="cb8-105"><a href=""></a></span>
<span id="cb8-106"><a href=""></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb8-107"><a href=""></a>    run_interface()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section id="conclusion" class="title-slide slide level1 center">
<h1>Conclusion</h1>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="logo_fseg.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Markdown_Projet_M1_Python_Markdown_AYDOGMUS_BENOUDINA_JDID_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>